<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" class="logo" width="120"/>

## Python 複製機制解析（copy 模組）

### 1. 複製類型概述

Python 的 `copy` 模組提供兩種物件複製方式：

- **淺拷貝 (Shallow Copy)**
新建組合物件，但直接插入對原始子物件的**引用**
- **深拷貝 (Deep Copy)**
新建組合物件，並遞歸建立所有子物件的**副本**


### 2. 圖解說明

**原始結構範例：**

```
物件 x
├─ 引用 → 物件 a
└─ 引用 → 物件 b
```


#### 淺拷貝過程：

```
新建 x' (x的副本)
├─ 引用 → 原始物件 a
└─ 引用 → 原始物件 b
```

- 修改 x' 的頂層屬性不會影響 x
- 若修改 a 或 b 的內容，x 和 x' 都會受影響


#### 深拷貝過程：

```
新建 x'' (x的副本)
├─ 引用 → 新建 a'' (a的副本)
└─ 引用 → 新建 b'' (b的副本)
```

- x'' 與 x 完全獨立，修改任何層級的內容都互不影響


### 3. 關鍵差異比較

| 特性 | 淺拷貝 | 深拷貝 |
| :-- | :-- | :-- |
| 複製層級 | 僅頂層物件 | 遞歸所有嵌套物件 |
| 記憶體使用 | 較少 | 較多 |
| 適用場景 | 簡單結構（無嵌套可變物件） | 複雜結構（含嵌套可變物件） |
| 模組方法 | `copy.copy()` | `copy.deepcopy()` |

### 4. 實務注意點

- **可變物件警惕**：對列表/字典等做淺拷貝時，嵌套內容仍共享引用
- **不可變物件例外**：如字串/數字等不可變類型，深/淺拷貝效果相同
- **自定義物件**：需實作 `__copy__()` 和 `__deepcopy__()` 方法來控制複製行為

---

**範例情境：**
當處理多層嵌套的配置檔案數據時，使用深拷貝可避免修改新配置時意外污染原始數據。

