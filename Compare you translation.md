這段短案例研究的最後一個任務是比較你翻譯的序列與 NCBI 網站上的官方序列。

首先回顧一下之前如何讀取 DNA 序列檔案。

在之前的程式碼中，我們將輸入檔案名稱定義為 dna.txt。接著開啟檔案，並一次讀取整個檔案。

另一種讀取整個檔案的方法通常更受歡迎，也就是使用 `with` 語句。這種方法更佳的原因在於，它更能應對檔案讀取過程中可能發生的錯誤。你可以在網路上找到更多關於 `with` 語句的資訊。

現在示範如何使用 `with` 語句。複製之前的程式碼，第一行 (輸入檔案名稱) 不變。

使用 `with` 語句時，`with` 這個詞會變成該行的第一個語句。第二個語句是 `open`，它會開啟檔案。在行尾加上 `as f`。在這裡，我們使用 `with` 語句開啟檔案，並將其檔案物件命名為 `f`。

現在需要縮排第三行 `seq = f.read()`。這是因為 `with` 是一個複合語句，因此以冒號結尾，所以後面的行必須縮排。

現在將讀取序列的程式碼轉換為一個函數，該函數讀取檔案並自動將 `\n` 和 `\r` 字元替換為空字串。

我們將定義一個名為 `read_seq` 的函數。首先，使用 `def` 關鍵字。輸入參數將是 `inputfile`，並且需要加上冒號。前兩行將讀取檔案，但必須確保縮排這兩行。

下一步是用空字串替換 `\n` 和 `\r`。同樣，需要縮排這些程式碼。

最後，需要將序列回傳給呼叫此函數的程式碼。所以使用 `return sequence`。

趁著對這個函數還記憶猶新，先新增一個簡短的說明字串 (docstring)。這個函數會讀取並回傳輸入序列，並且移除特殊字元。

現在定義好函數後，先執行函數的定義。然後就可以試著使用它了。

首先讀取蛋白質序列，所以輸入 `prt = read_seq("protein.txt")`。函數執行完畢。

也可以透過輸入 `DNA = read_seq("dna.txt")` 來讀取 DNA 序列。現在也讀取了 DNA 序列。

我們可以嘗試翻譯 DNA 序列，但在這種情況下，輸出會是空字串。這表示 DNA 序列的長度可能有問題。

如果查看 DNA 序列的長度，可以確認它是否可以被 3 整除。在這個例子中，餘數為 2，所以我們知道它不能被 3 整除。

為了理解問題所在，回到 NCBI 網站。查看標示為 CDS 的位置，你會看到旁邊有兩個數字 21 和 938。這些是編碼序列的起點和終點。因此，我們應該從第 21 個位置開始，到第 938 個位置結束，進行翻譯，而不是使用整個 DNA 序列。

可以使用字串切片來取得我們想要的部分序列。但是，需要注意索引。如果查看 NCBI 網站，你會發現序列位置是從 1 到 1157 編號的。在 Python 中，索引從 0 開始，因此基因體位置 21 和 938 對應於 Python 字串位置 20 和 937。

所以字串切片的起點是 20，但終點是 938。這是因為當我們指定終點為 938 時，包含的最後一個字元是位置 937 上的字元，這正是我們想要的。

現在嘗試重新執行翻譯函數。我們採用 DNA 序列，但不是全部。在這個例子中，我們從 20 開始，到 938 結束。在這種情況下，至少得到了一個翻譯結果。

接著印出蛋白質序列，也就是 `prt`。如果比較這兩個序列，你會發現它們幾乎相同。這兩個序列之間唯一的區別是翻譯序列末尾出現的底線字元。

這就是問題所在。在蛋白質編碼序列的末尾，會有一個所謂的終止密碼子。有三個終止密碼子，它們的作用是告訴讀取序列的人，應該停止讀取的位置。它有點像段落結束符號。

下載的蛋白質中不包含終止密碼子，因為通常不感興趣。但是，當我們下載 DNA 序列並自行翻譯時，翻譯中會包含終止密碼子。

因此，我們應該從翻譯中省略最後一個密碼子，並且可以修改切片的終點。

現在嘗試重新執行蛋白質翻譯，但不是在 938 結束切片，而是在 935 結束切片。在這種情況下，蛋白質看起來與下載的蛋白質相同。

為了確認是否相同，我們可以詢問 Python `prt`（下載的蛋白質）是否等於翻譯後的蛋白質。當我們在螢幕上執行這行程式碼時，Python 回傳 `true`，這表示成功。

另一種方法如下：

`translate` 函數回傳一個胺基酸字串。因此，我可以省略翻譯的胺基酸序列的最後一個字元，而不是省略 DNA 序列的最後三個字元。

讓我們試著執行它。在這個例子中，我們希望將蛋白質翻譯到位置 938，但要排除翻譯的最後一個字元。這就是我們從頭開始切片輸出，並且只排除最後一個字元的原因。

同樣，翻譯後的蛋白質與我們下載的蛋白質序列相同。

在這個案例研究中，我們完成了四個任務。首先，我們從網站上手動下載了 DNA 和蛋白質序列資料。第二，我們將 DNA 資料匯入 Python。接著，我們建立了一個使用字典翻譯 DNA 的演算法。最後，我們確認 DNA 翻譯是否與下載的胺基酸序列（蛋白質字串）相符，結果是相符的。

希望你們喜歡這個案例研究，並學到很多 Python 知識。
